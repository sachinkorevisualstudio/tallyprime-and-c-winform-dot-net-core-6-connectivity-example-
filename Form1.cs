using System.Text;
using System.Net.Http;

namespace WinFormsApp1
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }
        private string CreateRequest()
        {
            return @"
           <ENVELOPE>
 <HEADER>
  <TALLYREQUEST>Import Data</TALLYREQUEST>
 </HEADER>
 <BODY>
  <IMPORTDATA>
   <REQUESTDESC>
    <REPORTNAME>Vouchers</REPORTNAME>
    <STATICVARIABLES>
     <SVCURRENTCOMPANY>SAHYADRI STONE CRUSHER</SVCURRENTCOMPANY>
    </STATICVARIABLES>
   </REQUESTDESC>
   <REQUESTDATA>
   
   
   
   
   
   
<TALLYMESSAGE xmlns:UDF=""TallyUDF""><VOUCHER><OLDAUDITENTRYIDS.LIST TYPE=""Number""><OLDAUDITENTRYIDS>-1</OLDAUDITENTRYIDS></OLDAUDITENTRYIDS.LIST><NARRATION>1-12-2023**700LTR  HARSHNIKIT PETROBY RATE OF 88.46</NARRATION><DATE>1-12-2023</DATE><REFERENCEDATE>1-12-2023</REFERENCEDATE><VCHSTATUSDATE>1-12-2023</VCHSTATUSDATE><GUID> </GUID><GSTREGISTRATIONTYPE>Regular</GSTREGISTRATIONTYPE><STATENAME>Karnataka</STATENAME><COUNTRYOFRESIDENCE>India</COUNTRYOFRESIDENCE><PARTYGSTIN>29ADWPP6675K3Z8</PARTYGSTIN><PLACEOFSUPPLY>Karnataka</PLACEOFSUPPLY><GSTREGISTRATION TAXTYPE=""GST"" TAXREGISTRATION=""27ADVFS2344H1ZM"">Maharashtra Registration</GSTREGISTRATION><CMPGSTIN>27ADVFS2344H1ZM</CMPGSTIN><VOUCHERTYPENAME>Journal</VOUCHERTYPENAME><PARTYLEDGERNAME>HARSHANIKIT PETROLEUM</PARTYLEDGERNAME><VOUCHERNUMBER> </VOUCHERNUMBER><CMPGSTREGISTRATIONTYPE>Regular</CMPGSTREGISTRATIONTYPE><REFERENCE> 700</REFERENCE><CMPGSTSTATE>Maharashtra</CMPGSTSTATE><NUMBERINGSTYLE>Auto Retain</NUMBERINGSTYLE><CSTFORMISSUETYPE>&#4; Not Applicable</CSTFORMISSUETYPE><CSTFORMRECVTYPE>&#4; Not Applicable</CSTFORMRECVTYPE><FBTPAYMENTTYPE>Default</FBTPAYMENTTYPE><PERSISTEDVIEW>Accounting Voucher View</PERSISTEDVIEW><VCHSTATUSTAXADJUSTMENT>Default</VCHSTATUSTAXADJUSTMENT><VCHSTATUSVOUCHERTYPE>Journal</VCHSTATUSVOUCHERTYPE><VCHSTATUSTAXUNIT>Maharashtra Registration</VCHSTATUSTAXUNIT><VCHGSTCLASS>&#4; Not Applicable</VCHGSTCLASS><VCHENTRYMODE>As Voucher</VCHENTRYMODE><DIFFACTUALQTY>No</DIFFACTUALQTY><ISMSTFROMSYNC>No</ISMSTFROMSYNC><ISDELETED>No</ISDELETED><ISSECURITYONWHENENTERED>No</ISSECURITYONWHENENTERED><ASORIGINAL>No</ASORIGINAL><AUDITED>No</AUDITED><ISCOMMONPARTY>No</ISCOMMONPARTY><FORJOBCOSTING>No</FORJOBCOSTING><ISOPTIONAL>No</ISOPTIONAL><USEFOREXCISE>No</USEFOREXCISE><ISFORJOBWORKIN>No</ISFORJOBWORKIN><ALLOWCONSUMPTION>No</ALLOWCONSUMPTION><USEFORINTEREST>No</USEFORINTEREST><USEFORGAINLOSS>No</USEFORGAINLOSS><USEFORGODOWNTRANSFER>No</USEFORGODOWNTRANSFER><USEFORCOMPOUND>No</USEFORCOMPOUND><USEFORSERVICETAX>No</USEFORSERVICETAX><ISREVERSECHARGEAPPLICABLE>No</ISREVERSECHARGEAPPLICABLE><ISSYSTEM>No</ISSYSTEM><ISFETCHEDONLY>No</ISFETCHEDONLY><ISGSTOVERRIDDEN>No</ISGSTOVERRIDDEN><ISCANCELLED>No</ISCANCELLED><ISONHOLD>No</ISONHOLD><ISSUMMARY>No</ISSUMMARY><ISECOMMERCESUPPLY>No</ISECOMMERCESUPPLY><ISBOENOTAPPLICABLE>No</ISBOENOTAPPLICABLE><ISGSTSECSEVENAPPLICABLE>No</ISGSTSECSEVENAPPLICABLE><IGNOREEINVVALIDATION>No</IGNOREEINVVALIDATION><CMPGSTISOTHTERRITORYASSESSEE>No</CMPGSTISOTHTERRITORYASSESSEE><PARTYGSTISOTHTERRITORYASSESSEE>No</PARTYGSTISOTHTERRITORYASSESSEE><IRNJSONEXPORTED>No</IRNJSONEXPORTED><IRNCANCELLED>No</IRNCANCELLED><IGNOREGSTCONFLICTINMIG>No</IGNOREGSTCONFLICTINMIG><ISOPBALTRANSACTION>No</ISOPBALTRANSACTION><IGNOREGSTFORMATVALIDATION>No</IGNOREGSTFORMATVALIDATION><ISELIGIBLEFORITC>No</ISELIGIBLEFORITC><UPDATESUMMARYVALUES>No</UPDATESUMMARYVALUES><ISEWAYBILLAPPLICABLE>No</ISEWAYBILLAPPLICABLE><ISDELETEDRETAINED>No</ISDELETEDRETAINED><ISNULL>No</ISNULL><ISEXCISEVOUCHER>No</ISEXCISEVOUCHER><EXCISETAXOVERRIDE>No</EXCISETAXOVERRIDE><USEFORTAXUNITTRANSFER>No</USEFORTAXUNITTRANSFER><ISEXER1NOPOVERWRITE>No</ISEXER1NOPOVERWRITE><ISEXF2NOPOVERWRITE>No</ISEXF2NOPOVERWRITE><ISEXER3NOPOVERWRITE>No</ISEXER3NOPOVERWRITE><IGNOREPOSVALIDATION>No</IGNOREPOSVALIDATION><EXCISEOPENING>No</EXCISEOPENING><USEFORFINALPRODUCTION>No</USEFORFINALPRODUCTION><ISTDSOVERRIDDEN>No</ISTDSOVERRIDDEN><ISTCSOVERRIDDEN>No</ISTCSOVERRIDDEN><ISTDSTCSCASHVCH>No</ISTDSTCSCASHVCH><INCLUDEADVPYMTVCH>No</INCLUDEADVPYMTVCH><ISSUBWORKSCONTRACT>No</ISSUBWORKSCONTRACT><ISVATOVERRIDDEN>No</ISVATOVERRIDDEN><IGNOREORIGVCHDATE>No</IGNOREORIGVCHDATE><ISVATPAIDATCUSTOMS>No</ISVATPAIDATCUSTOMS><ISDECLAREDTOCUSTOMS>No</ISDECLAREDTOCUSTOMS><VATADVANCEPAYMENT>No</VATADVANCEPAYMENT><VATADVPAY>No</VATADVPAY><ISCSTDELCAREDGOODSSALES>No</ISCSTDELCAREDGOODSSALES><ISVATRESTAXINV>No</ISVATRESTAXINV><ISSERVICETAXOVERRIDDEN>No</ISSERVICETAXOVERRIDDEN><ISISDVOUCHER>No</ISISDVOUCHER><ISEXCISEOVERRIDDEN>No</ISEXCISEOVERRIDDEN><ISEXCISESUPPLYVCH>No</ISEXCISESUPPLYVCH><GSTNOTEXPORTED>No</GSTNOTEXPORTED><IGNOREGSTINVALIDATION>No</IGNOREGSTINVALIDATION><ISGSTREFUND>No</ISGSTREFUND><OVRDNEWAYBILLAPPLICABILITY>No</OVRDNEWAYBILLAPPLICABILITY><ISVATPRINCIPALACCOUNT>No</ISVATPRINCIPALACCOUNT><VCHSTATUSISVCHNUMUSED>No</VCHSTATUSISVCHNUMUSED><VCHGSTSTATUSISINCLUDED>No</VCHGSTSTATUSISINCLUDED><VCHGSTSTATUSISUNCERTAIN>No</VCHGSTSTATUSISUNCERTAIN><VCHGSTSTATUSISEXCLUDED>No</VCHGSTSTATUSISEXCLUDED><VCHGSTSTATUSISAPPLICABLE>No</VCHGSTSTATUSISAPPLICABLE><VCHGSTSTATUSISGSTR2BRECONCILED>No</VCHGSTSTATUSISGSTR2BRECONCILED><VCHGSTSTATUSISGSTR2BONLYINPORTAL>No</VCHGSTSTATUSISGSTR2BONLYINPORTAL><VCHGSTSTATUSISGSTR2BONLYINBOOKS>No</VCHGSTSTATUSISGSTR2BONLYINBOOKS><VCHGSTSTATUSISGSTR2BMISMATCH>No</VCHGSTSTATUSISGSTR2BMISMATCH><VCHGSTSTATUSISGSTR2BINDIFFPERIOD>No</VCHGSTSTATUSISGSTR2BINDIFFPERIOD><VCHGSTSTATUSISRETEFFDATEOVERRDN>No</VCHGSTSTATUSISRETEFFDATEOVERRDN><VCHGSTSTATUSISOVERRDN>No</VCHGSTSTATUSISOVERRDN><VCHGSTSTATUSISSTATINDIFFDATE>No</VCHGSTSTATUSISSTATINDIFFDATE><VCHGSTSTATUSISRETINDIFFDATE>No</VCHGSTSTATUSISRETINDIFFDATE><VCHGSTSTATUSMAINSECTIONEXCLUDED>No</VCHGSTSTATUSMAINSECTIONEXCLUDED><VCHGSTSTATUSISBRANCHTRANSFEROUT>No</VCHGSTSTATUSISBRANCHTRANSFEROUT><VCHGSTSTATUSISSYSTEMSUMMARY>No</VCHGSTSTATUSISSYSTEMSUMMARY><VCHSTATUSISUNREGISTEREDRCM>No</VCHSTATUSISUNREGISTEREDRCM><VCHSTATUSISOPTIONAL>No</VCHSTATUSISOPTIONAL><VCHSTATUSISCANCELLED>No</VCHSTATUSISCANCELLED><VCHSTATUSISDELETED>No</VCHSTATUSISDELETED><VCHSTATUSISOPENINGBALANCE>No</VCHSTATUSISOPENINGBALANCE><VCHSTATUSISFETCHEDONLY>No</VCHSTATUSISFETCHEDONLY><PAYMENTLINKHASMULTIREF>No</PAYMENTLINKHASMULTIREF><ISSHIPPINGWITHINSTATE>No</ISSHIPPINGWITHINSTATE><ISOVERSEASTOURISTTRANS>No</ISOVERSEASTOURISTTRANS><ISDESIGNATEDZONEPARTY>No</ISDESIGNATEDZONEPARTY><HASCASHFLOW>No</HASCASHFLOW><ISPOSTDATED>No</ISPOSTDATED><USETRACKINGNUMBER>No</USETRACKINGNUMBER><ISINVOICE>No</ISINVOICE><MFGJOURNAL>No</MFGJOURNAL><HASDISCOUNTS>No</HASDISCOUNTS><ASPAYSLIP>No</ASPAYSLIP><ISCOSTCENTRE>No</ISCOSTCENTRE><ISSTXNONREALIZEDVCH>No</ISSTXNONREALIZEDVCH><ISEXCISEMANUFACTURERON>No</ISEXCISEMANUFACTURERON><ISBLANKCHEQUE>No</ISBLANKCHEQUE><ISVOID>No</ISVOID><ORDERLINESTATUS>No</ORDERLINESTATUS><VATISAGNSTCANCSALES>No</VATISAGNSTCANCSALES><VATISPURCEXEMPTED>No</VATISPURCEXEMPTED><ISVATRESTAXINVOICE>No</ISVATRESTAXINVOICE><VATISASSESABLECALCVCH>No</VATISASSESABLECALCVCH><ISVATDUTYPAID>Yes</ISVATDUTYPAID><ISDELIVERYSAMEASCONSIGNEE>No</ISDELIVERYSAMEASCONSIGNEE><ISDISPATCHSAMEASCONSIGNOR>No</ISDISPATCHSAMEASCONSIGNOR><ISDELETEDVCHRETAINED>No</ISDELETEDVCHRETAINED><CHANGEVCHMODE>No</CHANGEVCHMODE><RESETIRNQRCODE>No</RESETIRNQRCODE><ALTERID></ALTERID><MASTERID> </MASTERID><VOUCHERKEY></VOUCHERKEY><VOUCHERRETAINKEY></VOUCHERRETAINKEY><VOUCHERNUMBERSERIES>Default</VOUCHERNUMBERSERIES><EWAYBILLDETAILS.LIST>      </EWAYBILLDETAILS.LIST><EXCLUDEDTAXATIONS.LIST>      </EXCLUDEDTAXATIONS.LIST><OLDAUDITENTRIES.LIST>      </OLDAUDITENTRIES.LIST><ACCOUNTAUDITENTRIES.LIST>      </ACCOUNTAUDITENTRIES.LIST><AUDITENTRIES.LIST>      </AUDITENTRIES.LIST><DUTYHEADDETAILS.LIST>      </DUTYHEADDETAILS.LIST><GSTADVADJDETAILS.LIST>      </GSTADVADJDETAILS.LIST><CONTRITRANS.LIST>      </CONTRITRANS.LIST><EWAYBILLERRORLIST.LIST>      </EWAYBILLERRORLIST.LIST><IRNERRORLIST.LIST>      </IRNERRORLIST.LIST><HARYANAVAT.LIST>      </HARYANAVAT.LIST><SUPPLEMENTARYDUTYHEADDETAILS.LIST>      </SUPPLEMENTARYDUTYHEADDETAILS.LIST><INVOICEDELNOTES.LIST>      </INVOICEDELNOTES.LIST><INVOICEORDERLIST.LIST>      </INVOICEORDERLIST.LIST><INVOICEINDENTLIST.LIST>      </INVOICEINDENTLIST.LIST><ATTENDANCEENTRIES.LIST>      </ATTENDANCEENTRIES.LIST><ORIGINVOICEDETAILS.LIST>      </ORIGINVOICEDETAILS.LIST><INVOICEEXPORTLIST.LIST>      </INVOICEEXPORTLIST.LIST><ALLLEDGERENTRIES.LIST><OLDAUDITENTRYIDS.LIST TYPE=""Number""><OLDAUDITENTRYIDS>-1</OLDAUDITENTRYIDS></OLDAUDITENTRYIDS.LIST><APPROPRIATEFOR>&#4; Not Applicable</APPROPRIATEFOR><LEDGERNAME>DIESEL EXPENSES</LEDGERNAME><GSTCLASS>&#4; Not Applicable</GSTCLASS><ISDEEMEDPOSITIVE>Yes</ISDEEMEDPOSITIVE><LEDGERFROMITEM>No</LEDGERFROMITEM><REMOVEZEROENTRIES>No</REMOVEZEROENTRIES><ISPARTYLEDGER>No</ISPARTYLEDGER><GSTOVERRIDDEN>No</GSTOVERRIDDEN><ISGSTASSESSABLEVALUEOVERRIDDEN>No</ISGSTASSESSABLEVALUEOVERRIDDEN><STRDISGSTAPPLICABLE>No</STRDISGSTAPPLICABLE><STRDGSTISPARTYLEDGER>No</STRDGSTISPARTYLEDGER><STRDGSTISDUTYLEDGER>No</STRDGSTISDUTYLEDGER><CONTENTNEGISPOS>No</CONTENTNEGISPOS><ISLASTDEEMEDPOSITIVE>Yes</ISLASTDEEMEDPOSITIVE><ISCAPVATTAXALTERED>No</ISCAPVATTAXALTERED><ISCAPVATNOTCLAIMED>No</ISCAPVATNOTCLAIMED><AMOUNT> -61922</AMOUNT><VATEXPAMOUNT>-61922</VATEXPAMOUNT><SERVICETAXDETAILS.LIST>       </SERVICETAXDETAILS.LIST><BANKALLOCATIONS.LIST>       </BANKALLOCATIONS.LIST><BILLALLOCATIONS.LIST>       </BILLALLOCATIONS.LIST><INTERESTCOLLECTION.LIST>       </INTERESTCOLLECTION.LIST><OLDAUDITENTRIES.LIST>       </OLDAUDITENTRIES.LIST><ACCOUNTAUDITENTRIES.LIST>       </ACCOUNTAUDITENTRIES.LIST><AUDITENTRIES.LIST>       </AUDITENTRIES.LIST><INPUTCRALLOCS.LIST>       </INPUTCRALLOCS.LIST><INVENTORYALLOCATIONS.LIST><STOCKITEMNAME>DIESEL</STOCKITEMNAME><ISDEEMEDPOSITIVE>Yes</ISDEEMEDPOSITIVE><ISGSTASSESSABLEVALUEOVERRIDDEN>No</ISGSTASSESSABLEVALUEOVERRIDDEN><STRDISGSTAPPLICABLE>No</STRDISGSTAPPLICABLE><CONTENTNEGISPOS>No</CONTENTNEGISPOS><ISLASTDEEMEDPOSITIVE>Yes</ISLASTDEEMEDPOSITIVE><ISAUTONEGATE>No</ISAUTONEGATE><ISCUSTOMSCLEARANCE>No</ISCUSTOMSCLEARANCE><ISTRACKCOMPONENT>No</ISTRACKCOMPONENT><ISTRACKPRODUCTION>No</ISTRACKPRODUCTION><ISPRIMARYITEM>No</ISPRIMARYITEM><ISSCRAP>No</ISSCRAP><RATE> 88.46/LTR</RATE><AMOUNT>-61922</AMOUNT><ACTUALQTY>700 LTR</ACTUALQTY><BILLEDQTY>700 LTR</BILLEDQTY><BATCHALLOCATIONS.LIST> <GODOWNNAME>Main Location</GODOWNNAME> <BATCHNAME>Primary Batch</BATCHNAME> <INDENTNO>&#4; Not Applicable</INDENTNO> <ORDERNO>&#4; Not Applicable</ORDERNO> <TRACKINGNUMBER>&#4; Not Applicable</TRACKINGNUMBER> <DYNAMICCSTISCLEARED>No</DYNAMICCSTISCLEARED> <AMOUNT> -61922</AMOUNT> <ACTUALQTY> 700 LTR</ACTUALQTY> <BILLEDQTY>700 LTR</BILLEDQTY> <ADDITIONALDETAILS.LIST>         </ADDITIONALDETAILS.LIST> <VOUCHERCOMPONENTLIST.LIST>         </VOUCHERCOMPONENTLIST.LIST></BATCHALLOCATIONS.LIST><DUTYHEADDETAILS.LIST>        </DUTYHEADDETAILS.LIST><RATEDETAILS.LIST>        </RATEDETAILS.LIST><SUPPLEMENTARYDUTYHEADDETAILS.LIST>        </SUPPLEMENTARYDUTYHEADDETAILS.LIST><TAXOBJECTALLOCATIONS.LIST>        </TAXOBJECTALLOCATIONS.LIST><COSTTRACKALLOCATIONS.LIST>        </COSTTRACKALLOCATIONS.LIST><REFVOUCHERDETAILS.LIST>        </REFVOUCHERDETAILS.LIST><EXCISEALLOCATIONS.LIST>        </EXCISEALLOCATIONS.LIST><EXPENSEALLOCATIONS.LIST>        </EXPENSEALLOCATIONS.LIST></INVENTORYALLOCATIONS.LIST><DUTYHEADDETAILS.LIST>       </DUTYHEADDETAILS.LIST><EXCISEDUTYHEADDETAILS.LIST>       </EXCISEDUTYHEADDETAILS.LIST><RATEDETAILS.LIST>       </RATEDETAILS.LIST><SUMMARYALLOCS.LIST>       </SUMMARYALLOCS.LIST><CENVATDUTYALLOCATIONS.LIST>       </CENVATDUTYALLOCATIONS.LIST><STPYMTDETAILS.LIST>       </STPYMTDETAILS.LIST><EXCISEPAYMENTALLOCATIONS.LIST>       </EXCISEPAYMENTALLOCATIONS.LIST><TAXBILLALLOCATIONS.LIST>       </TAXBILLALLOCATIONS.LIST><TAXOBJECTALLOCATIONS.LIST>       </TAXOBJECTALLOCATIONS.LIST><TDSEXPENSEALLOCATIONS.LIST>       </TDSEXPENSEALLOCATIONS.LIST><VATSTATUTORYDETAILS.LIST>       </VATSTATUTORYDETAILS.LIST><REFVOUCHERDETAILS.LIST>       </REFVOUCHERDETAILS.LIST><INVOICEWISEDETAILS.LIST>       </INVOICEWISEDETAILS.LIST><VATITCDETAILS.LIST>       </VATITCDETAILS.LIST><ADVANCETAXDETAILS.LIST>       </ADVANCETAXDETAILS.LIST><TAXTYPEALLOCATIONS.LIST>       </TAXTYPEALLOCATIONS.LIST></ALLLEDGERENTRIES.LIST><ALLLEDGERENTRIES.LIST><OLDAUDITENTRYIDS.LIST TYPE=""Number""><OLDAUDITENTRYIDS>-1</OLDAUDITENTRYIDS></OLDAUDITENTRYIDS.LIST><APPROPRIATEFOR>&#4; Not Applicable</APPROPRIATEFOR><LEDGERNAME> HARSHANIKIT PETROLEUM</LEDGERNAME><GSTCLASS>&#4; Not Applicable</GSTCLASS><ISDEEMEDPOSITIVE>No</ISDEEMEDPOSITIVE><LEDGERFROMITEM>No</LEDGERFROMITEM><REMOVEZEROENTRIES>No</REMOVEZEROENTRIES><ISPARTYLEDGER>Yes</ISPARTYLEDGER><GSTOVERRIDDEN>No</GSTOVERRIDDEN><ISGSTASSESSABLEVALUEOVERRIDDEN>No</ISGSTASSESSABLEVALUEOVERRIDDEN><STRDISGSTAPPLICABLE>No</STRDISGSTAPPLICABLE><STRDGSTISPARTYLEDGER>No</STRDGSTISPARTYLEDGER><STRDGSTISDUTYLEDGER>No</STRDGSTISDUTYLEDGER><CONTENTNEGISPOS>No</CONTENTNEGISPOS><ISLASTDEEMEDPOSITIVE>No</ISLASTDEEMEDPOSITIVE><ISCAPVATTAXALTERED>No</ISCAPVATTAXALTERED><ISCAPVATNOTCLAIMED>No</ISCAPVATNOTCLAIMED><AMOUNT> 61922</AMOUNT><VATEXPAMOUNT>61922 </VATEXPAMOUNT><SERVICETAXDETAILS.LIST>       </SERVICETAXDETAILS.LIST><BANKALLOCATIONS.LIST>       </BANKALLOCATIONS.LIST><BILLALLOCATIONS.LIST>       </BILLALLOCATIONS.LIST><INTERESTCOLLECTION.LIST>       </INTERESTCOLLECTION.LIST><OLDAUDITENTRIES.LIST>       </OLDAUDITENTRIES.LIST><ACCOUNTAUDITENTRIES.LIST>       </ACCOUNTAUDITENTRIES.LIST><AUDITENTRIES.LIST>       </AUDITENTRIES.LIST><INPUTCRALLOCS.LIST>       </INPUTCRALLOCS.LIST><DUTYHEADDETAILS.LIST>       </DUTYHEADDETAILS.LIST><EXCISEDUTYHEADDETAILS.LIST>       </EXCISEDUTYHEADDETAILS.LIST><RATEDETAILS.LIST>       </RATEDETAILS.LIST><SUMMARYALLOCS.LIST>       </SUMMARYALLOCS.LIST><CENVATDUTYALLOCATIONS.LIST>       </CENVATDUTYALLOCATIONS.LIST><STPYMTDETAILS.LIST>       </STPYMTDETAILS.LIST><EXCISEPAYMENTALLOCATIONS.LIST>       </EXCISEPAYMENTALLOCATIONS.LIST><TAXBILLALLOCATIONS.LIST>       </TAXBILLALLOCATIONS.LIST><TAXOBJECTALLOCATIONS.LIST>       </TAXOBJECTALLOCATIONS.LIST><TDSEXPENSEALLOCATIONS.LIST>       </TDSEXPENSEALLOCATIONS.LIST><VATSTATUTORYDETAILS.LIST>       </VATSTATUTORYDETAILS.LIST><COSTTRACKALLOCATIONS.LIST>       </COSTTRACKALLOCATIONS.LIST><REFVOUCHERDETAILS.LIST>       </REFVOUCHERDETAILS.LIST><INVOICEWISEDETAILS.LIST>       </INVOICEWISEDETAILS.LIST><VATITCDETAILS.LIST>       </VATITCDETAILS.LIST><ADVANCETAXDETAILS.LIST>       </ADVANCETAXDETAILS.LIST><TAXTYPEALLOCATIONS.LIST>       </TAXTYPEALLOCATIONS.LIST></ALLLEDGERENTRIES.LIST><GST.LIST>      </GST.LIST><PAYROLLMODEOFPAYMENT.LIST>      </PAYROLLMODEOFPAYMENT.LIST><ATTDRECORDS.LIST>      </ATTDRECORDS.LIST><GSTEWAYCONSIGNORADDRESS.LIST>      </GSTEWAYCONSIGNORADDRESS.LIST><GSTEWAYCONSIGNEEADDRESS.LIST>      </GSTEWAYCONSIGNEEADDRESS.LIST><TEMPGSTRATEDETAILS.LIST>      </TEMPGSTRATEDETAILS.LIST><TEMPGSTADVADJUSTED.LIST>      </TEMPGSTADVADJUSTED.LIST></VOUCHER></TALLYMESSAGE><TALLYMESSAGE xmlns:UDF=""TallyUDF""><COMPANY><REMOTECMPINFO.LIST MERGE=""Yes""><NAME> </NAME><REMOTECMPNAME>SAHYADRI STONE CRUSHER</REMOTECMPNAME><REMOTECMPSTATE>Maharashtra</REMOTECMPSTATE></REMOTECMPINFO.LIST></COMPANY></TALLYMESSAGE><TALLYMESSAGE xmlns:UDF=""TallyUDF""><COMPANY><REMOTECMPINFO.LIST MERGE=""Yes""><NAME> </NAME><REMOTECMPNAME>SAHYADRI STONE CRUSHER</REMOTECMPNAME><REMOTECMPSTATE>Maharashtra</REMOTECMPSTATE></REMOTECMPINFO.LIST></COMPANY></TALLYMESSAGE>

   
   
   
   
   
   
   
   
	
   </REQUESTDATA>
  </IMPORTDATA>
 </BODY>
</ENVELOPE>
            ";
        }
        private void Form1_Load(object sender, EventArgs e)
        {

        }

        private async void button1_sendtotally_Click(object sender, EventArgs e)
        {
            string url = "http://127.0.0.1:9000";
            string contentType = "text/xml";

            try
            {
                string voucher = CreateRequest();

                using (HttpClient client = new HttpClient())
                using (HttpContent content = new StringContent(voucher, Encoding.UTF8, contentType))
                using (HttpResponseMessage response = await client.PostAsync(url, content))
                {
                    logTextBox.AppendText($"Response from Tally:\n{await response.Content.ReadAsStringAsync()}\n\n");
                }
            }
            catch (HttpRequestException ex)
            {
                logTextBox.AppendText($"Error: {ex.Message}\n\n");
            }
            catch (Exception ex)
            {
                logTextBox.AppendText($"Unexpected Error: {ex.GetType().Name} - {ex.Message}\n\n");
            }
        }
    }
}